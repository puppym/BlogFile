## B树和B+树

 B+树改进了B树, 让内结点只作索引使用, 去掉了其中指向data record的指针, 使得每个结点中能够存放更多的key, 因此能有更大的出度. 这有什么用? 这样就意味着存放同样多的key, 树的层高能进一步被压缩, 使得检索的时间更短。



![img](https://images2015.cnblogs.com/blog/576154/201609/576154-20160907130956629-1833512478.png)

 

如图所示，区别有以下两点：

1. B+树中只有叶子节点会带有指向记录的指针（ROWID），而B树则所有节点都带有，在内部节点出现的索引项不会再出现在叶子节点中。

2. B+树中所有叶子节点都是通过指针连接在一起，而B树不会。



B+树的优点：

1. 非叶子节点不会带上ROWID，这样，一个块中可以容纳更多的索引项，一是可以降低树的高度。二是一个内部节点可以定位更多的叶子节点。
2. 叶子节点之间通过指针来连接，范围扫描将十分简单，而对于B树来说，则需要在叶子节点和内部节点不停的往返移动。



B树中每个节点的关键字都有data域，而B+树除了叶子节点，其他节点只有索引，也就是说同样的磁盘页B+树可以容纳更多的节点。

B+树的范围查询更加方便，可以先找到范围下限，然后通过叶子结点的链表顺序遍历，直至找到上限即可。而B树只能先找到下限，通过中序遍历查找，直到找到上限。

### ACID

#### 1. 原子性（Atomicity）

事务被视为不可分割的最小单元，事务的所有操作要么全部提交成功，要么全部失败回滚。

回滚可以用回滚日志（Undo Log）来实现，回滚日志记录着事务所执行的修改操作，在回滚时反向执行这些修改操作即可。

#### [#](http://www.cyc2018.xyz/数据库/数据库系统原理.html#_2-一致性-consistency)2. 一致性（Consistency）

数据库在事务执行前后都保持一致性状态。在一致性状态下，所有事务对同一个数据的读取结果都是相同的。

#### [#](http://www.cyc2018.xyz/数据库/数据库系统原理.html#_3-隔离性-isolation)3. 隔离性（Isolation）

一个事务所做的修改在最终提交以前，对其它事务是不可见的。

#### [#](http://www.cyc2018.xyz/数据库/数据库系统原理.html#_4-持久性-durability)4. 持久性（Durability）

一旦事务提交，则其所做的修改将会永远保存到数据库中。即使系统发生崩溃，事务执行的结果也不能丢失。

系统发生崩溃可以用重做日志（Redo Log）进行恢复，从而实现持久性。与回滚日志记录数据的逻辑修改不同，重做日志记录的是数据页的物理修改。

## 数据库范式

第一范式：属性不可分。

第二范式：每个非主属性依赖于键码。可以通过主键来分解非主属性。

第三范式：非主属性不传递函数依赖于键码，	