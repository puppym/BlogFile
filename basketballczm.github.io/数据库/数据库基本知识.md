# 数据库基本知识

1. 3级模式2级映射。3级模式分为外模式，概念模式，内模式。两级映射外模式/模式映象，模式/内模式映象。这样可以使得用户可以逻辑处理数据，不必要关心数据的底层表示方式和存储方式。

外模式/模式映象:当概念模式发生改变时，只要修改外模式/模式映象，可保持外模式不变，从而保证用户应用程序不变，保证了数据与用户的逻辑独立性。
模式/内模式映象:当数据库的内部存储结构发生改变时，只要修改模式/内模式映象，可保持概念模式不变，从而保持外模式以及用户程序的不变，保证了数据与程序的物理独立性——数据的物理独立性

2. 关系模型
模型的3个方面:数据结构，语义完整性，数据操作。
域：一组具有相同数据类型的值的集合。每个属性有一个域。
属性：二维表格中的每一列。
元组：每一行称为关系的一个元组。
基数：元组的个数
度：列的数目
视图：其元组使依赖于基本关系的虚关系。

# 代数运算
主要有6种代数运算：选择，投影，笛卡尔积(自然连接)，并集，差集，重命名。

## 集合运算

- 投影(π): 投影是从πa1,a2,a3(R)，这种关系是从表R中选出a1,a2,a3属性的列，然后组成一个集合。
- 选择(σ): σψ(R),这里ψ是由一些与或非的逻辑运算组成命题公式，这种选择是从R中选出符合条件ψ的所有元组。
- 重命名: ρa/b(R)的一元运算，相当于表R中的所有b**字段**被命名成a**字段**。

## 连接
### 自然连接(⋈)

R⋈S是R和S的自然连接，结果是在R和S中在他们公共属性名字上相等的所有元组的组合。自然语言的定义为：R⋈S={t∪s:t∈R, s∈S,fun(t∪s)}。这里的fun(r)是对于二元关系r为真的谓词，当且仅当r使函数的二元关系。t通常要求R和S必须至少有一个公共属性，如果省去这个约束条件则自然连接就变成了完全的笛卡尔积。


**雇员表**

Name  |  EmpId  |  DeptName 
----- |  ----- |  ----
Harry|3415|财务
Sally|2241|销售
George|3401|财务
Harriet|2202|销售

**部门**

DeptName|Manager
----|----
财务|George
销售|Harriet
生产|Charles

**雇员⋈部门**

Name|EmpId|DeptName|Manager
---|---|---|---
Harry|3415|财务|George
Sally|2241|销售|Harriet
George|3402|财务|George
Harriet|2202|销售|Harriet

说明：在上述例子中，外键成立于从雇员.DeptName到部门.DeptName，雇员和部门的自然连接组合了所有雇员和它们的部门。注意这能工作因为外键在相同名字的属性之间保持。如果不是这样，外键成立于从部门.manager到雇员.emp-number，则我们必须在采用自然连接之前必须重命名这些列。


### θ-连接和相等连接
R⋈θS = σθ(R×S) 在算子θ是等号算子的时候这个连接也是相等连接。支持自然连接和重命名的计算机语言可以不需要θ-连接，因为它可以通过对自然连接（在没有公共属性的时候的它退化为笛卡尔积）的选择来完成。(当没有公共属性时先使用重命名的自然连接，然后对结果进行选择来完成)

**车**

CarModel | CarPrice
---|---
CarA|20000
CarB|30000
CarC|50000

**船**

BoatModel | BoatPrice
---|---
Boat1|10000
Boat2|40000
Boat3|60000

**车⋈船CarPrice>=BoatPrice**

CarModel|CarPrice|BoatModel|BoatPrice
---|---|---|---
CarA|20000|Boat1|10000
CarB|30000|Boat1|10000
CarC|50000|Boat1|10000
CarC|50000|Boat2|40000


### 半连接(⋉)(⋊)
半连接是类似于自然连接的写做R⋉S连接，注意R⋉S！= S⋉R连接，以前者为例，半连接的结果只是在S中有在公共属性名字上相等的元组所有的R中的元组。半连接的语义表达式R⋉S={t:t∈R, s∈S,fun(t∪s)}。半连接也可以使用自然连接进行模拟R⋉S=πa1,a2...an(R⋈S)。

**雇员表**

Name  |  EmpId  |  DeptName 
----- |  ----- |  ----
Harry|3415|财务
Sally|2241|销售
George|3401|财务
Harriet|2202|生产

**部门**

DeptName|Manager
----|----
销售|Harriet
生产|Charles

**雇员⋉部门**

Name|EmpId|DeptName
---|---|---
Sally|2241|销售
Harriet|2202|生产

### 反连接
反连接是类似于自然连接的写法R▷S的连接，反连接的结果就是在S中没有在公共属性名字上相等的元组的R中的那些元组。反连接形式的定义：R▷S={t:t∈R¬∃s∈S:fun(t∪s)} 或{t:t∈R, S 中没有s满足fun(t∪s)} 或者R-R⋉S。

**雇员表**

Name  |  EmpId  |  DeptName 
----- |  ----- |  ----
Harry|3415|财务
Sally|2241|销售
George|3401|财务
Harriet|2202|销售

**部门**

DeptName|Manager
----|----
销售|Harriet
生产|Charles

**雇员▷部门**

Name|EmpId|DeptName
---|---|---
Harry|3415|财务
George|3401|财务

### 除法(÷)
R÷S

**完成**

Student |Task
---|----
Fred    |Database1
Fred    |Database2
Fred    |Compiler1
Eugene  |Database1
Eugene  |Compiler1
Sara    |Database1
Sara    |Database2

**DB项目**

Task |
---|
Database1 |
Database2 |

**完成÷DB项目**

Student |
---|
Fred|
Sara|

## 外连接
外连接分为：左外连接(⟕), 右外连接(⟖), 全外连接(⟗)。本节定义的运算假定“空”值ω的存在性，我们不定义它，并且把它用作为一个填充值。

### 左外连接(⟕)
左外连接写成R⟕S，其中R与S为关系。左外连接的结果包含R中的所有元组，对于每个元组，若在S中有公共属性名字上相等的元组，则正常连接，若在S没有公共属性名字上相等的元组，则依旧保持此元组，并将其他列设置为NULL。关系代数：(R⋈S)∪(R-πr1,r2,...,rn(R⋈S))X{(ω,ω,...,ω)}。

### 右外连接(⟖)
右外连接写成R⟖S，其中R与S为关系，右外连接的结果包含S中所有元组，对于每个元组，若R中有公共属性名字上相等的元素，则正常连接，若在R没有公共属性名字上相等的元组，则依旧保持此元组，并将其他列设置为NULL。关系代数：(R⋈S)∪(S-πs1,s2,...,sn(R⋈S))X{(ω,ω,...,ω)}。

### 全外连接(⟗)
全外连接写成R⟗S，其中R与S为关系。全外连接的结果包含R与S中的所有元组，对于每个元组，若在另一关系上中有在公共属性名字上相等的元组，则正常连接，若在R中没有在公共属性名字上相等的元组，则依旧保持此元组，并将对应其他列设为NULL。R⟗S=(R⟕S)∪(R⟖S)。

# 参考链接
- https://zh.wikipedia.org/wiki/%E5%85%B3%E7%B3%BB%E4%BB%A3%E6%95%B0_(%E6%95%B0%E6%8D%AE%E5%BA%93)


<meta http-equiv="refresh" content="50">