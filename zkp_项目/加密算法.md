

## 加密算法

加密算法分为对称加密和非对称加密算法，对称加密加解密使用同一密钥，非对称加密加解公钥加密，公钥加密，私钥解密。

对称加密主要有：DES，AES。虽然加解密速度比较快，但是密钥管理不安全，密钥管理负担重。

非对称加密：安全性更高，公钥是公开的，密钥自己保存。但是加解密时间较长，速度慢。

混合使用方法：首先将对称加密的密钥使用非对称加密的公钥进行加密，然后发送出去，然后使用私钥进行解密得到对称加密的密钥，然后双方使用对称加密来进行通讯。对于小的数据量，使用非对称加解密也是可以接受的。

## 非对称加密算法

### RSA

[RSA(非对称加密)与ECC（椭圆曲线加密）的区别](https://blog.csdn.net/weixin_42117918/article/details/86421877)

[浅谈常见的七种加密算法及实现](https://juejin.im/post/5b48b0d7e51d4519962ea383#heading-22)

* RSA签名算法适合于：Verify操作频度高，而Sign操作频度低的应用场景。比如，分布式系统中基于capability的访问控制就是这样的一种场景。
* ECDSA签名算法适合于：Sign和Verify操作频度相当的应用场景。比如，点对点的安全信道建立。

### ECC(椭圆曲线密码)

实际包含以下内容：

* 基于椭圆曲线的公钥密码
* 基于椭圆曲线的数字签名
* 基于椭圆曲线的密钥交换

基于的数学问题，在椭圆曲线的运算上利用了`椭圆曲线上的离散对数问题`的复杂性。该问题的本质是`以知点xG求数x的问题`，定义为`已知椭圆曲线E，E上的一点G，以及G的x倍点xG，求x`。

#### 椭圆曲线加密解密算法原理

[加解密过程原理](https://blog.csdn.net/weixin_42117918/article/details/86421877) 加解密的保障是椭圆曲线上离散对数的问题。在验证的等式中其实就是把私钥隐藏在公钥中，然后由公钥推不出私钥。

#### 椭圆曲线签名算法原理（ECDSA）

[签名过程原理](https://blog.csdn.net/weixin_42117918/article/details/86421877)

#### EdDSA签名算法

EdDSA签名算法基于ECC的签名算法，比特币使用的是ECDSA签名基于曲线secp256k1。注意secp256r1曲线因为默认使用Dual_EC_DRBG随机数生成器被留有后门，因为ECDSA签名算法的安全性比较依赖于安全的随机数生成算法。

EdDSA签名算法由于曲线和参数的选择不同可以划分为Ed25519和Ed448算法，分别基于curve25519曲线和curve448曲线。使用较多的是Ed25519算法。扭曲爱德华兹曲线（Twisted Edwards curves），因为相比于后者而言运行速度要更快，密钥和签名空间也较小。

通过观察签名过程，我们发现一个私钥对通过过一个消息M进行签名时R与S都是固定的[EdDSA过程详解](https://www.anquanke.com/post/id/167018)，所以说EdDSA是一种确定性的签名算法，不像ECDSA那样每次签名都根据选取的随机数的变化而不同，所以EdDSA的安全性也就不在依赖于随机数生成器。ED25519采用Schnorr机制作为签名的构建方式，是的签名与验证的性能得到巨大提升。

EdDSA的运算速度也比ECDSA算法要快很多，门罗币和zcash都也已经切换到了EdDSA，目前被确认为下一代椭圆曲线算法。

EdDSA具体过程参见 [针对EdDSA的fault attack](https://www.anquanke.com/post/id/167018)  [针对数字签名机制](https://tiannian.me/2018/12/28/cryptography/ed25519/)

#### EdDSA和ECDSA之间的差异

EdDSA的计算速度和安全性都要比ECDSA好。其中的一个原因是EdDSA在签名的时候不用选随机数，其随机数的选取依赖于hash安全性。

**ECDSA签名要保证r有足够的随机性，保证每次签名的随机数都不一样，如果两个签名的随机数相同，那么将有办法获取原始的私钥。**

我们在做签名的时候，要保证r的足够随机性，这样保障每一个签名都不一样，如果r一直使用的是同一个，将有办法获取原始的私钥 k。

对于消息M1 和 M2 的签名(r1, s1) 和 （r2, s2）

首先因为随机数r相同，则r1 == r2，因为r为公钥的x坐标。

由于`s = (h + kx)/r`

`r = (s2-s1)^-1*(h2-h1)`  1

`k = x^-1 * (sr - h)`  2

将1带入2中

`k = x^-1 *  (s*(s2-s1)^-1*(h2-h1) - h)`

因此可以求出最后的私钥k。



### 常见的签名加密算法

* MD5 算法用的是hash函数，是对一段信息产生消息摘要，以防止被篡改。该再要函数无论输入是多大，最后的输出都会变成一个128bit的串。

* SHA1也是消息摘要算法，比MD5的安全性更强，已于长度小于2^64位的消息，SHA1会产生一个160位的消息摘要，消息摘要到原消息是不可逆的过程。主要用于文件完整性检查以及数字签名等领域。

* HMAC算法是和密钥相关的哈希运算消息认证码，HMAC运算利用哈希算法(MD5,SHA1等)，以一个密钥和一个消息作为输入生成一个消息摘要作为输出。

  HMAC发送放和接收方都有key进行计算，但是第三方是没有该key的，因此无法计算出正确的散列值，这样能够防止数据被篡改。

* 对称加密方式DES，3DES，AES，安全性依次增加。

  DES加解密都都使用同一密钥，是一种分组加密方式，以64为为一组进行加密，密钥长度为56，加解密使用同一算法。

  3DES对同一块进行三个不同的密钥进行3次加密，强度更高。

  AES是`对称分组密码体制`，密钥长度最少为128为，算法容易在各种硬件和软件平台上使用。

* RSA是第一个能够同时用于加密和数字签名的算法。

* ECC比RAS有更小的密钥，安全级别更高，都是非对称加密方法，但是相比于RSA，ECC加解密操作消耗更多的CPU。

### 各种加密算法性能对比

[各种加密算法对比](https://juejin.im/post/5b48b0d7e51d4519962ea383#heading-8)

[由数学知识引出椭圆曲线](https://mp.weixin.qq.com/s?__biz=MzAwMjEzNzAzNQ==&mid=2650719438&idx=2&sn=63e085dbf2f4c573661185f99bdb486c&chksm=82c56a6ab5b2e37cc55bbff7b8513c228ceddcd4c14524d78d410bb0e7929385f9738b648936&scene=21#wechat_redirect)





