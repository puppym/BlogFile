该篇文章简单介绍了最初的重入攻击的原理以及存在的现象：

https://ethereum.stackexchange.com/questions/6176/what-is-a-recursive-calling-vulnerability



该篇文章详细记录了涉及重入攻击的账户以及对应的交易：

https://ethereum.stackexchange.com/questions/6320/how-many-the-dao-recursive-call-vulnerability-attacks-have-occurred-to-date



下面一篇文章介绍了DAO合约一共由多少资金被窃取，分析的结果是通过具体的脚本进行分析获取。

https://ethereum.stackexchange.com/questions/6408/how-many-ethers-have-been-drained-through-the-recursive-call-attacks-on-the-dao



以下两个地址为最初的攻击合约

[0xf835a0247b0063c04ef22006ebe57c5f11977cc4](http://etherscan.io/address/0xf835a0247b0063c04ef22006ebe57c5f11977cc4#internaltx) and [0xc0ee9db1a9e07ca63e4ff0d5fb6f86bf68d47b89](http://etherscan.io/address/0xc0ee9db1a9e07ca63e4ff0d5fb6f86bf68d47b89#internaltx):





0xbb9bc244d798123fde783fcc1c72d3bb8c189413 该地址为DAO合约的地址

0xd2e16A20dd7B1ae54fB0312209784478D069c7B0   ManagedAccount

acctackContract -> DAO.splitDAO()   ->   DAO.withdrawRewardFor()  -> ManagedAccount.payOut()  ->

 attackContract()



另外一种攻击方式：

外部账户-> 合约地址 -> 



下面一笔交易为重入攻击交易

https://etherscan.io/tx/0xfa19dcc4af83627730f63ca92281a87d00e3c5d9f06b173d55e2ce5a47283440/advanced#internal

0xfa19dcc4af83627730f63ca92281a87d00e3c5d9f06b173d55e2ce5a47283440





## 分析总结

根据上面的分析结果，一共总结出在以太坊主网上已经出现的重入攻击涉及的账户和交易分别如下：

```
As of 22/06/2016 AEST, 5+ attacks are identified below:
2# 
0xaE8Ad906948EF5ad5e95eed52990FF89312887D7
0x0f6994bd16df20f0d0992a607ab78e8be1a05cb07b411437fed2fec83be1bc9c
160.09485354 Ether 转账到账户 0xfe24cdd8648121a43a7c86d289be4dd2951ed49f

https://www.reddit.com/r/ethereum/comments/4ot3z8/dao_is_under_attack_again/
0xe500732effa4922a97671cd310c613ba88c32315
0x0f6994bd16df20f0d0992a607ab78e8be1a05cb07b411437fed2fec83be1bc9c
0x201c0253a6fd5d5e7efb0617acb115dcbd39731869bfba796d7f9656eda3c5f2

3#
0x1eb9bd9c2236649b15ee8be1961b40397a64a166
0xfa19dcc4af83627730f63ca92281a87d00e3c5d9f06b173d55e2ce5a47283440
2.123311222 Ether 转账到账户 0xf14c14075d6c4ed84b86798af0956deef67365b5

4# 
0xf68d23ee23703a99d8374a71a92ec0678354498e
0x27a52fd947e623d3393ca59f3e99c654938d387657bf7c12a04f736c27f45648
269.80994743 Ether 转账到账户 0xfe24cdd8648121a43a7c86d289be4dd2951ed49f

5#
0x2ed6dac2b01a2a27803d6fe4f8e9729e92a8dfcf
0x4613f3bca5c44ea06337a9e439fbc6d42e501d0a

6#
0x2ba9d006c1d72e67a70b5526fc6b4b0c0fd6d334
0x60c58610f70682454d88483e289b7a374b274e546d4f28e76900b9520b40880d
7,277,336.423038517 Ether 转账到账户 0xb136707642a4ea12fb4bae820f03d2562ebff487

Update 11:54 22/06/2016 AEST
0x4f0daa112142ffc4ba1b9f3b76bcd238a094d65b
0x6f8c0d2751e7e18325e1a113019a9ae5372f306d5424722f79d2123a0eb7d598
转账的目的账户： 0x84ef4b2357079cd7a7c69fd7a37cd0609a679106

0xf835a0247b0063c04ef22006ebe57c5f11977cc4
0xc0ee9db1a9e07ca63e4ff0d5fb6f86bf68d47b89

Update 22:03 22/06/2016

Details on the amounts drained are available in How many ethers have been drained through the recursive call attacks on The DAO?.

This script will only search for Transfer events where the _to: address is 0x0000000000000000000000000000000000000000 as this is a characteristic of the recursive call vulnerability hack transfers. The many Transfer events from the same address will be located in the same block number.

下面是通过getTheDAOTransferEvents进行详细分析，其结果如下：
首先包括最初的两个地址：
0xf835a0247b0063c04ef22006ebe57c5f11977cc4
0xc0ee9db1a9e07ca63e4ff0d5fb6f86bf68d47b89

0xae8ad906948ef5ad5e95eed52990ff89312887d7
0x0f6994bd16df20f0d0992a607ab78e8be1a05cb07b411437fed2fec83be1bc9c
160.09485354 Ether 转账160.09485354 Ether到 0xfe24cdd8648121a43a7c86d289be4dd2951ed49f
这次攻击就是上面第一次检测的盗取22个Eth的交易

0x1eb9bd9c2236649b15ee8be1961b40397a64a166
0xfa19dcc4af83627730f63ca92281a87d00e3c5d9f06b173d55e2ce5a47283440
2.123311222 Ether 转账到 0xf14c14075d6c4ed84b86798af0956deef67365b5

Update 21/06/2016



```

初步总结如下：

```
// 合约账户
0xaE8Ad906948EF5ad5e95eed52990FF89312887D7
// example
0x0f6994bd16df20f0d0992a607ab78e8be1a05cb07b411437fed2fec83be1bc9c
0x201c0253a6fd5d5e7efb0617acb115dcbd39731869bfba796d7f9656eda3c5f2

// 外部账户
0xe500732effa4922a97671cd310c613ba88c32315  => 0xaE8Ad906948EF5ad5e95eed52990FF89312887D7
0x0f6994bd16df20f0d0992a607ab78e8be1a05cb07b411437fed2fec83be1bc9c
0x201c0253a6fd5d5e7efb0617acb115dcbd39731869bfba796d7f9656eda3c5f2

// 合约账户
0x1eb9bd9c2236649b15ee8be1961b40397a64a166
0xfa19dcc4af83627730f63ca92281a87d00e3c5d9f06b173d55e2ce5a47283440
0xbe59e34d74d034f2e0126a26d23c174ec79cc779d68b2272f9fb2264a0ff5b24
0x4f0b2b1db00d093723a9a117af37c28da5990b483a344d5154bd40fc45c38808

// 合约账户
0xf68d23ee23703a99d8374a71a92ec0678354498e
0x27a52fd947e623d3393ca59f3e99c654938d387657bf7c12a04f736c27f45648

// 合约账户
0x2ba9d006c1d72e67a70b5526fc6b4b0c0fd6d334
0x60c58610f70682454d88483e289b7a374b274e546d4f28e76900b9520b40880d

0x4f0daa112142ffc4ba1b9f3b76bcd238a094d65b
0x6f8c0d2751e7e18325e1a113019a9ae5372f306d5424722f79d2123a0eb7d598

// 外部合约账户
0xf835a0247b0063c04ef22006ebe57c5f11977cc4
0xc0ee9db1a9e07ca63e4ff0d5fb6f86bf68d47b89

```

